import { defineStore } from 'pinia'

export const useRestHousesStore = defineStore('restHouse', {
    state: () => ({
        data: [
            {
                "id": "bb2ded1a-9e33-4351-8837-4e5f396894ce",
                "name": "Robles Inc",
                "num_room": 9,
                "num_bath": 5,
                "description": "Manage smile particular say whatever institution. Notice dinner simply pay apply event.\nYou herself player a color worry. Short benefit attention voice system office hour. Health into voice.",
                "location": "732 Fuller Village Apt. 742\nSouth Marioburgh, MD 60375",
                "capacity": 9,
                "owner_id": "704d28d8-43b6-48fb-ae76-1be1f98f967a",
                "terms": "Never often themselves blue. Mission in improve skin drug. Traditional image service defense wait similar.",
                "period": [
                    {
                        "parts": [
                            {
                                "endTime": "12:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "5:00 PM",
                                "startTime": "1:00 PM"
                            },
                            {
                                "endTime": "10:00 PM",
                                "startTime": "6:00 PM"
                            }
                        ],
                        "title": "4 hours"
                    },
                    {
                        "parts": [
                            {
                                "endTime": "2:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "9:00 PM",
                                "startTime": "3:00 PM"
                            }
                        ],
                        "title": "6 hours"
                    },
                    {
                        "parts": [
                            {
                                "endTime": "5:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "11:59 PM",
                                "startTime": "6:00 PM"
                            }
                        ],
                        "title": "9 hours"
                    }
                ],
                "phone": "652.174.0642x1136",
                "prices": {
                    "4 hours": {
                        "weekday": 400,
                        "weekend": 600
                    },
                    "6 hours": {
                        "weekday": 7000,
                        "weekend": 1000
                    },
                    "9 hours": {
                        "weekday": 1100,
                        "weekend": 1400
                    }
                }
            },
            {
                "id": "df8e1b50-83c2-4efe-866a-a03644a266b1",
                "name": "Martinez-Lyons",
                "num_room": 3,
                "num_bath": 5,
                "description": "Both before cell marriage task probably. Thousand skin can head. Church produce view another.\nFuture know spend condition. Customer only employee lot. Article toward according control organization.",
                "location": "5549 Samantha Trafficway\nWest Lisa, MO 38195",
                "capacity": 5,
                "owner_id": "405a7b3a-575f-4a96-8053-8fe4c4bd393a",
                "terms": "Exactly wear travel west. Heavy bring star machine present statement.\nBox protect bad detail state. The least west may mean. Congress yourself memory player stock member.",
                "period": [
                    {
                        "parts": [
                            {
                                "endTime": "12:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "5:00 PM",
                                "startTime": "1:00 PM"
                            },
                            {
                                "endTime": "10:00 PM",
                                "startTime": "6:00 PM"
                            }
                        ],
                        "title": "4 hours"
                    },
                    {
                        "parts": [
                            {
                                "endTime": "2:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "9:00 PM",
                                "startTime": "3:00 PM"
                            }
                        ],
                        "title": "6 hours"
                    },
                    {
                        "parts": [
                            {
                                "endTime": "5:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "11:59 PM",
                                "startTime": "6:00 PM"
                            }
                        ],
                        "title": "9 hours"
                    }
                ],
                "phone": "+1-350-267-4302",
                "prices": {
                    "4 hours": {
                        "weekday": 400,
                        "weekend": 600
                    },
                    "6 hours": {
                        "weekday": 7000,
                        "weekend": 1000
                    },
                    "9 hours": {
                        "weekday": 1100,
                        "weekend": 1400
                    }
                }
            },
            {
                "id": "dae1457a-d818-4797-89e5-f02a82c43ffd",
                "name": "Simpson, Johnson and Smith",
                "num_room": 1,
                "num_bath": 5,
                "description": "Hold add last service. He on sense drop term.\nSon parent society experience world movie forget describe. Discover will admit black.",
                "location": "812 Lane Crossing Apt. 255\nDixonland, NY 71466",
                "capacity": 1,
                "owner_id": "24471d9c-fd53-4021-9f7d-a1e4b9d248ae",
                "terms": "Half drive understand mind then exist. Serve require role executive response four build. Area rock enjoy business.",
                "period": [
                    {
                        "parts": [
                            {
                                "endTime": "12:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "5:00 PM",
                                "startTime": "1:00 PM"
                            },
                            {
                                "endTime": "10:00 PM",
                                "startTime": "6:00 PM"
                            }
                        ],
                        "title": "4 hours"
                    },
                    {
                        "parts": [
                            {
                                "endTime": "2:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "9:00 PM",
                                "startTime": "3:00 PM"
                            }
                        ],
                        "title": "6 hours"
                    },
                    {
                        "parts": [
                            {
                                "endTime": "5:00 PM",
                                "startTime": "8:00 AM"
                            },
                            {
                                "endTime": "11:59 PM",
                                "startTime": "6:00 PM"
                            }
                        ],
                        "title": "9 hours"
                    }
                ],
                "phone": "549.495.3647x6502",
                "prices": {
                    "4 hours": {
                        "weekday": 400,
                        "weekend": 600
                    },
                    "6 hours": {
                        "weekday": 7000,
                        "weekend": 1000
                    },
                    "9 hours": {
                        "weekday": 1100,
                        "weekend": 1400
                    }
                }
            }
        ],
        nextId: 1,
    }),
    getters: {
        getList: (state) => state.data,
    },
    actions: {
        addRestHouse(item:any) {
            const exists = this.data.some((existingItem:any) => existingItem?.id === item?.id);

            if (!exists) {
                if (!item.id) {
                    item.id = this.nextId++;
                }
                this.data.push(item);
            } else {
                console.warn(`Item with id ${item.id} already exists.`);
            }
        },
        updateRestHouse(el:any) {
            let index = this.data.findIndex((item:any) => item?.id === el?.id);
            if (index !== -1) {
                this.data[index] = el;
            } else {
                console.warn(`Item with id ${el.id} not found.`);
            }
        },
        addPeriod(id: any, data: any) {
            const { period, prices } = data;
            const index = this.data.findIndex((existingItem: any) => existingItem?.id === id);

            if (index > -1) {
                const item = this.data[index];

                if (item.period) {
                    item.period.push(period);
                } else {
                    item.period = [period];
                }

                if (item.prices) {
                    item.prices[prices.title] = { weekday: prices.weekday, weekend: prices.weekend };
                } else {
                    item.prices = { [prices.title]: { weekday: prices.weekday, weekend: prices.weekend } };
                }
            } else {
                console.warn(`Item with id ${id} not found.`);
            }
        },
        editPeriod(id: any, data: any) {
            const { period, prices } = data;
            const index = this.data.findIndex((item: any) => item?.id === id);
            const periodTitle = period?.title

            if (index > -1) {
                const item = this.data[index];

                const periodIndex = item?.period?.findIndex((p: any) => p?.title == periodTitle)

                if (periodIndex > -1) {
                    item.period[periodIndex] = period;
                    item.prices[period.title] = {
                        weekday: prices.weekday,
                        weekend: prices.weekend
                    }
                } else {
                    console.warn(`Period with title "${periodTitle}" not found in item with id ${id}.`);
                }
            } else {
                console.warn(`Item with id ${id} not found.`);
            }
        },
        deleteRestHouse(item: any) {
            const index = this.data.findIndex((item: any) => item.id === item.id);
            if (index > -1) {
                this.data.splice(index, 1);
            } else {
                console.warn(`The item not found.`);
            }
        },
        deletePeriod(id: any, periodTitle: string) {
            const index = this.data.findIndex((item: any) => item.id === id);
            if (index > -1) {
                const item = this.data[index];
                const periodIndex = item?.period?.findIndex((p: any) => p?.title === periodTitle);

                if (periodIndex > -1) {
                    item.period.splice(periodIndex, 1);
                    delete item.prices[periodTitle];
                } else {
                    console.warn(`Period with title "${periodTitle}" not found in item with id ${id}.`);
                }
            } else {
                console.warn(`Item with id ${id} not found.`);
            }
        },
    }
})
